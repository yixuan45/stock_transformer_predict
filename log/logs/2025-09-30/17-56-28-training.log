2025-09-30 17:56:28,357 - root - INFO - ===== 价格预测模型开始运行 =====
2025-09-30 17:56:28,357 - root - INFO - 开始数据处理...
2025-09-30 17:56:28,357 - data_loader - INFO - 从./data/min_eth_data.csv加载数据
2025-09-30 17:56:28,371 - data_loader - INFO - 数据加载完成,形状:(20000, 7)
2025-09-30 17:56:28,371 - data_loader - INFO - 开始数据预处理...
2025-09-30 17:56:28,371 - data_loader - INFO - 使用 minmax 方法标准化数据
2025-09-30 17:56:28,386 - data_loader - INFO - 创建序列 - 输入长度: 30, 预测长度: 1
2025-09-30 17:57:12,479 - data_loader - INFO - 序列创建完成 - 特征形状: (19970, 30, 6), 目标形状: (19970, 1)
2025-09-30 17:57:14,716 - data_loader - INFO - 数据预处理完成
2025-09-30 17:57:14,753 - data_loader - INFO - 数据加载器创建完成 - 训练集: 13979, 验证集: 1997, 测试集: 3994
2025-09-30 17:57:14,755 - root - INFO - 数据处理完成 - 训练集: 13979, 验证集: 1997, 测试集: 3994
2025-09-30 17:57:14,755 - root - INFO - 初始化模型...
2025-09-30 17:57:14,827 - root - INFO - 模型类型: encoder 型Transformer
2025-09-30 17:57:14,828 - root - INFO - 模型参数数量: 100,865
2025-09-30 17:57:14,828 - root - INFO - 开始模型训练...
2025-09-30 17:57:14,988 - trainer - INFO - 开始模型训练...
2025-09-30 17:57:16,823 - root - ERROR - 程序运行出错: mat1 and mat2 shapes cannot be multiplied (1920x6 and 5x64)
Traceback (most recent call last):
  File "E:\pythonProjet\transformer_stock_predict\main.py", line 36, in main
    trainer.train()
  File "E:\pythonProjet\transformer_stock_predict\trainer\trainer.py", line 160, in train
    train_loss = self.train_one_epoch(epoch)
  File "E:\pythonProjet\transformer_stock_predict\trainer\trainer.py", line 103, in train_one_epoch
    outputs = self.model(inputs)
  File "D:\anaconda\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "E:\pythonProjet\transformer_stock_predict\models\transformer.py", line 93, in forward
    src = self.input_projection(src)  # (seq_len, batch_size, d_model)
  File "D:\anaconda\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "D:\anaconda\envs\pytorch\lib\site-packages\torch\nn\modules\linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1920x6 and 5x64)
